---
title: "language_inventario"
author: "Cesar"
date: "24/9/2019"
output: html_document
---
```{r}

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}


library(tidyverse)
library(lubridate)
library(textcat)

#--------- Reading the data
uacj_library <- read_csv("C:/Users/G50/Desktop/Cesar' Shit/RecommenderSystem/inventario.csv", 
                         locale = readr::locale(encoding = "latin1"))

uacj_library %>% glimpse()

#--------- Changing upper to lower case
uacj_library$Titulo <-tolower(uacj_library$Titulo)

uacj_library %>% glimpse()

#--------- Cleaning function
rm_accent <- function(str,pattern="all") {
   if(!is.character(str))
    str <- as.character(str)

  pattern <- unique(pattern)

  if(any(pattern=="Ç"))
    pattern[pattern=="Ç"] <- "ç"

  symbols <- c(
    acute = "áéíóúÁÉÍÓÚýÝ",
    grave = "àèìòùÀÈÌÒÙ",
    circunflex = "âêîôûÂÊÎÔÛ",
    tilde = "ãõÃÕñÑ",
    umlaut = "äëïöüÄËÏÖÜÿ",
    cedil = "çÇ"
  )

  nudeSymbols <- c(
    acute = "aeiouAEIOUyY",
    grave = "aeiouAEIOU",
    circunflex = "aeiouAEIOU",
    tilde = "aoAOnN",
    umlaut = "aeiouAEIOUy",
    cedil = "cC"
  )

  accentTypes <- c("´","`","^","~","¨","ç")

  if(any(c("all","al","a","todos","t","to","tod","todo")%in%pattern)) # opcao retirar todos
    return(chartr(paste(symbols, collapse=""), paste(nudeSymbols, collapse=""), str))

  for(i in which(accentTypes%in%pattern))
    str <- chartr(symbols[i],nudeSymbols[i], str) 

  return(str)
}


rm_accent(uacj_library$Titulo)

#uacj_library %>% View()

#--------- Creating a column for language reference
uacj_library <- uacj_library %>% 
  mutate(language_reference = textcat(uacj_library$Titulo))

uacj_library %>% glimpse()  %>% View()

write.csv(uacj_library, file = "language_inventario.csv")

uacj_library %>% 
  filter(language_reference == "english")

str(uacj_library$language_reference)

```

